metric_identifier,metric_name,metric_def,metric_code,metric_type_id,system_id,data_set_id,metric_sql,metric_detail_sql,source_record_id_attribute,source_record_id_attribute_desc,unit_of_measure_id,load_details_ind,detail_sample_size,action_threshold,data_domain_id,dq_domain_id,change_description
253770bc-a331-4959-af67-2d929a43aa69,Number of platform accounts in source - Groot,A001.001 Total records in accounts_account table in Groot,ACC-DC-0001,8,13,21,select count(1) from public.accounts_account where ((  created_time) AT TIME ZONE 'UTC') < current_Date,,,,22,FALSE,,,1,4,renamed
203bbcbc-b9d5-46ca-9a3c-ad65d47084d5,Number of platform accounts in staging - DAP,A001.002 Total records in accounts_account table dap staging ,ACC-DC-0002,8,12,19,select count(distinct id) from staging.groot_accounts_account where di_current_flag = TRUE and cast (src_created_ts as date) < current_date();,,,,22,FALSE,,,1,4,updated sql to be distinct count
a71049c5-516f-4627-b281-c9c49bea16b3,Number of platform accounts in integration - DAP,A001.003 Total records in accounts_account table dap integration ,ACC-DC-0003,8,12,20,select count(*) from integration.dim_account where di_current_flag = TRUE and cast (src_created_ts as date) < current_date();,,,,22,FALSE,,,1,4,renamed
6b259a49-c1fc-4ed3-82f6-5cfd695e8765,Number of platform accounts in distribution - DAP ,A001.004 Total records in accounts_account table dap distribution ,ACC-DC-0015,8,12,31,select count(1) from distribution.dim_account_c where cast (src_created_ts as date) < current_date and src_identifier <> '-1',,,,22,FALSE,,,1,4,renamed
832590d5-c8a6-42bb-b351-fed3a05973d4,Number of days since last platform accounts loaded to staging - DAP,A001.005 Number of days since last account from groot loaded to dap staging,ACC-TI-0001,10,12,19,select extract (day from ( current_date - max(date(src_created_ts)) )) from staging.groot_accounts_account where di_current_flag and not di_deleted_flag,,,,22,FALSE,,,1,7,renamed
9a83fac8-fcc0-467d-a2e3-e727b5a82287,Var between Groot Accounts - Source vs Staging,A001.006 Variance between Groot Accounts and DAP Accounts in Staging,ACC-BC-0022,10,12,32,select (select total from quality_mart.dq_metric_totals mt join quality_mart.dq_metric_analysis ma on ma.metric_sk = mt.metric_sk where ma.metric_Code = 'ACC-DC-0001' and ma.active_indicator and mt.created_ts = (select max(mt2.created_ts) from  quality_mart.dq_metric_totals mt2 where mt2.metric_sk = mt.metric_sk and cast (mt2.created_ts as date)  = current_date   ) ) - (select total from quality_mart.dq_metric_totals mt join quality_mart.dq_metric_analysis ma on ma.metric_sk = mt.metric_sk where ma.metric_Code = 'ACC-DC-0002' and ma.active_indicator and mt.created_ts = (select max(mt2.created_ts) from  quality_mart.dq_metric_totals mt2 where mt2.metric_sk = mt.metric_sk and cast (mt2.created_ts as date)  = current_date   ) ),,,,22,FALSE,,100,1,4,renamed
c55011e4-19cf-4bf3-9b8d-8913eb9f80fc,Var between Groot Accounts - Staging vs Distribution,A001.007 Variance between DAP Accounts Staging and Distribution,ACC-BC-0023,10,12,32,select (select total from quality_mart.dq_metric_totals mt join quality_mart.dq_metric_analysis ma on ma.metric_sk = mt.metric_sk where ma.metric_Code = 'ACC-DC-0002' and ma.active_indicator and mt.created_ts = (select max(mt2.created_ts) from  quality_mart.dq_metric_totals mt2 where mt2.metric_sk = mt.metric_sk and cast (mt2.created_ts as date)  = current_date   ) ) - (select total from quality_mart.dq_metric_totals mt join quality_mart.dq_metric_analysis ma on ma.metric_sk = mt.metric_sk where ma.metric_Code = 'ACC-DC-0015' and ma.active_indicator and mt.created_ts = (select max(mt2.created_ts) from  quality_mart.dq_metric_totals mt2 where mt2.metric_sk = mt.metric_sk and cast (mt2.created_ts as date)  = current_date   ) ),,,,22,FALSE,,1,1,4,renamed
e2df3076-c749-4d85-a08a-16493843b297,Number of identityprovider in source - Groot,A002.001 Total record count in sso_identityprovider table in Groot,ACC-DC-0016,8,13,21,select count(1)  from sso_identityprovider a where  ((  created_time) AT TIME ZONE 'UTC') < current_Date,,,,22,FALSE,,,1,4,added new query
6095fcd7-65a3-4718-937a-ac1b11e4d67c,Number of identityprovider in staging - DAP,A002.002 Total record count in sso_identityprovider table in Staging,ACC-DC-0017,8,12,19,select count(distinct id) from staging.groot_sso_identityprovider  where di_current_flag and not di_deleted_flag and cast (src_created_ts as date) < current_date,,,,22,FALSE,,,1,4,updated sql to be a distinct count
16ca757a-daaf-46f2-ace0-dabb31a6994f,Variance between identityprovider in Groot vs DAP Staging,A002.003 Variance between Groot SSO Identity Provider Source vs Staging,ACC-BC-0024,10,12,32,select (select total from quality_mart.dq_metric_totals mt join quality_mart.dq_metric_analysis ma on ma.metric_sk = mt.metric_sk where ma.metric_Code = 'ACC-DC-0016' and ma.active_indicator and mt.created_ts = (select max(mt2.created_ts) from  quality_mart.dq_metric_totals mt2 where mt2.metric_sk = mt.metric_sk and cast (mt2.created_ts as date)  = current_date   ) ) - (select total from quality_mart.dq_metric_totals mt join quality_mart.dq_metric_analysis ma on ma.metric_sk = mt.metric_sk where ma.metric_Code = 'ACC-DC-0017' and ma.active_indicator and mt.created_ts = (select max(mt2.created_ts) from  quality_mart.dq_metric_totals mt2 where mt2.metric_sk = mt.metric_sk and cast (mt2.created_ts as date)  = current_date   ) ),,,,22,FALSE,,1,1,4,added new query
06d5fc01-91e1-4e2e-8dba-d683ae29154f,Number of userroutingrule in source - Groot,A003.001 Total record count in sso_userroutingrule table in Groot,ACC-DC-0018,8,13,21,select count(1)   from sso_userroutingrule a where  ((  created_time) AT TIME ZONE 'UTC') < current_Date,,,,22,FALSE,,,1,4,added new query
cb63835f-9a3c-49c8-bd0d-c326dbe1d8b5,Number of userroutingrule in staging - DAP,A003.002 Total record count in sso_user_routingrule table in Staging,ACC-DC-0019,8,12,19,select count(distinct id) from staging.groot_sso_userroutingrule  where di_current_flag and not di_deleted_flag and cast (src_created_ts as date) < current_date,,,,22,FALSE,,,1,4,updated sql to be distinct count
6c512692-58f0-4641-ae52-140f4805680f,Var between userroutingrule in Groot vs DAP Staging,A003.003 Variance between Groot User Routing Rule Source vs Staging,ACC-BC-0025,10,12,32,select (select total from quality_mart.dq_metric_totals mt join quality_mart.dq_metric_analysis ma on ma.metric_sk = mt.metric_sk where ma.metric_Code = 'ACC-DC-0018' and ma.active_indicator and mt.created_ts = (select max(mt2.created_ts) from  quality_mart.dq_metric_totals mt2 where mt2.metric_sk = mt.metric_sk and cast (mt2.created_ts as date)  = current_date   ) ) - (select total from quality_mart.dq_metric_totals mt join quality_mart.dq_metric_analysis ma on ma.metric_sk = mt.metric_sk where ma.metric_Code = 'ACC-DC-0019' and ma.active_indicator and mt.created_ts = (select max(mt2.created_ts) from  quality_mart.dq_metric_totals mt2 where mt2.metric_sk = mt.metric_sk and cast (mt2.created_ts as date)  = current_date   ) ),,,,22,FALSE,,1,1,4,added new query
b36d4276-8f60-4376-a731-bc9274467353,Number of accountrelationship in source - Groot,A004.001 Total record count in accounts_accountrelationship table in Groot,ACC-DC-0020,8,13,21,select count(1)  from accounts_accountrelationship   where  ((  created_time) AT TIME ZONE 'UTC') < current_Date ,,,,22,FALSE,,,1,4,added new query
88044e6d-d9c8-4788-9d50-443dd83f3c5d,Number of accountrelationship in staging - DAP,A004.002 Total record count in accounts_accountrelationship table in Staging,ACC-DC-0021,8,12,19,select count(distinct id) from staging.groot_accounts_accountrelationship where di_current_flag and not di_deleted_flag and cast (src_created_ts as date) < current_date,,,,22,FALSE,,,1,4,added new query
60c32341-eac8-4204-bc83-c791c031ae7f,Var between Groot accountrelationship - Source vs Staging,A004.003 Variance between Groot accounts_accountrelationship Source vs Staging,ACC-BC-0026,10,12,32,select (select total from quality_mart.dq_metric_totals mt join quality_mart.dq_metric_analysis ma on ma.metric_sk = mt.metric_sk where ma.metric_Code = 'ACC-DC-0020' and ma.active_indicator and mt.created_ts = (select max(mt2.created_ts) from  quality_mart.dq_metric_totals mt2 where mt2.metric_sk = mt.metric_sk and cast (mt2.created_ts as date)  = current_date   ) ) - (select total from quality_mart.dq_metric_totals mt join quality_mart.dq_metric_analysis ma on ma.metric_sk = mt.metric_sk where ma.metric_Code = 'ACC-DC-0021' and ma.active_indicator and mt.created_ts = (select max(mt2.created_ts) from  quality_mart.dq_metric_totals mt2 where mt2.metric_sk = mt.metric_sk and cast (mt2.created_ts as date)  = current_date   ) ),,,,22,FALSE,,1,1,4,added new query
1e9b81a9-467d-4dbf-8052-e5c8ad758e94,Number of externalaccountid in source - Groot,A005.001 Total record count in accounts_externalaccountid table in Groot,ACC-DC-0022,8,13,21,select count(1) from accounts_externalaccountid a join accounts_account aa on aa.id = a.account_id where  ((  aa.created_time) AT TIME ZONE 'UTC') <  current_Date,,,,22,FALSE,,,1,4,added new query
643c01e5-4c3f-47cb-8a42-426ca5f88200,Number of externalaccountid in staging - DAP,A005.002 Total record count in accounts_externalaccountid table in Staging,ACC-DC-0023,8,12,19,select count(distinct e.id) from staging.groot_accounts_externalaccountid e join staging.groot_accounts_account aa on aa.id = e.account_id where aa.di_current_flag and not aa.di_deleted_flag and e.di_current_flag and not e.di_deleted_flag and cast (aa.src_created_ts as date) < current_date,,,,22,FALSE,,,1,4,added new query
